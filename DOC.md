# TODO List 项目说明文档

## 1. 技术选型

### 1.1 编程语言与运行形态

- **编程语言**：原生 JavaScript（浏览器环境）
- **运行形态**：纯前端 Web 应用（静态页面）

**理由：**

- 题目并不要求后端能力，且 Todo 的核心逻辑相对简单，使用原生 JS 可以更直接地呈现思考过程。
- 纯前端实现部署成本极低（本地打开或静态托管即可），便于面试官快速运行和验证。

### 1.2 框架 / 库

- **UI 层**：不使用框架（非 React/Vue 等），直接操作 DOM
- **图表库**：Chart.js（通过 CDN 引入）

**理由：**

- 不使用前端框架的原因：
  - 代码量可控，用不到复杂状态管理。
  - 题目重点在于需求理解和逻辑设计，用原生 JS 更容易“看清楚每一步在做什么”。
- 使用 Chart.js 的原因：
  - 饼图、折线图等基础图表开箱即用，配置简单。
  - 不需要额外构建流程，直接 script 引入即可。

### 1.3 存储方案

- **存储方式**：浏览器 `localStorage`
- **数据结构**：`{ todos, categories }` 序列化为 JSON 字符串存入固定 key

**理由：**

- 单机使用场景下 `localStorage` 足够，API 简单、无需额外依赖。
- 不需要后端或数据库部署，方便提交和体验。

**替代方案对比：**

- **不选 IndexedDB**：
  - 虽然更适合大数据量和复杂查询，但本项目数据量很小，IndexedDB 的使用成本高。
- **不选后端数据库（例如 SQLite / MongoDB）**：
  - 会引入服务端部署、接口设计、鉴权等额外复杂度。


## 2. 项目结构设计

### 2.1 整体架构

本项目为单页 Web 应用，主要分为三层：

1. **视图层（HTML + CSS）**
   - `index.html`：整体结构，包括任务列表视图、统计视图、视图切换页签等。
   - `style.css`：布局、配色、交互反馈（hover、overdue 高亮、搜索高亮等）。

2. **逻辑层（main.js）**
   - 负责：
     - 管理全局状态（`todos` / `categories` / 新建任务的日期）
     - 读取和写入 `localStorage`
     - DOM 渲染和事件绑定
     - 统计数据计算与图表绘制
     - 过期提醒与归档处理逻辑

3. **外部库**
   - 仅通过 `<script>` 引入 Chart.js，用于绘制统计图。

### 2.2 目录结构

项目根目录结构大致如下：

```text
.
├── index.html      # 页面结构
├── style.css       # 样式
├── main.js         # 业务逻辑与状态管理
├── README.md       # 运行说明（给面试官看的快速入口）
└── DOC.md          # 本说明文档（设计与思考）
```

### 2.3 主要模块职责

* **状态与存储模块**

  * `todos` / `categories` 全局状态
  * `createTodo`：创建任务对象，统一字段结构
  * `loadFromStorage` / `saveToStorage`：加载与持久化
  
* **查询与过滤模块**

  * `getVisibleTodos`：

    * 按关键字搜索（标题 + 描述）
    * 按分类 / “今日任务”筛选
    * 按是否显示归档筛选
    * 最终返回排序后的任务列表

* **排序策略模块**

  * 内置在 `getVisibleTodos` 中：

    1. 未完成在前，已完成在后
    2. 未完成中，有日期的在前，无日期在后
    3. 有日期的按日期从早到晚
    4. 日期相同按创建时间排序

* **渲染模块**

  * `renderTodos`：渲染任务列表

    * 任务标题/描述搜索高亮
    * 日期显示 + 点击进入编辑
    * 完成状态样式
    * 过期高亮样式（提醒）
    * 归档/取消归档按钮、删除按钮
  * `renderCategorySelects`：渲染“添加任务分类下拉”和“筛选分类下拉”

* **统计模块**

  * `updateTodayDoneText`：更新“今日已完成 X 个任务”文案
  * `getTodayCompletedStats`：按分类汇总今日完成任务（给饼图用）
  * `getLast7DaysCompletedStats`：计算最近 7 天每天的完成任务数（给折线图用）
  * `renderStats`：绘制/刷新饼图和折线图，同时更新折线图下方的趋势说明文字

* **交互模块**

  * `addTodo` / `deleteTodo` / `toggleTodo` / `toggleArchive`
  * `editTodoCategory`：点击分类 Tag 后，临时变成 `<select>` 修改分类
  * `editTodoDueDate`：点击日期文本进入“日期选择 + 清除”编辑态
  * `openCreateDueDateEditor`：新建任务时的日期编辑逻辑
  * `bindEvents`：集中绑定按钮、输入框、页签、归档勾选等事件
  * `switchView`：在“列表视图”和“统计视图”之间切换



## 3. 需求细节与关键决策

### 3.1 字段必填与空输入处理

* **标题**：必填

  * 若为空，弹窗提示并聚焦回标题输入框。
* **描述**：选填

  * 可为空，不影响任务创建。
* **任务日期（dueDate）**：选填

  * 默认显示文案“未选择日期”，不强制用户选择。
  * 选择日期后自动保存；点击“清除”恢复为未选择状态。
* **分类**：在 UI 交互上要求必选

  * 通过下拉框选择分类；没有分类时引导先创建分类。
  * 避免出现无分类任务，方便统计和过滤。

### 3.2 已完成任务的表现形式

* 数据层：

  * `completed: boolean`
  * `completedAt: string | null`（YYYY-MM-DD）

    * 勾选完成：写入当天日期
    * 取消完成：重置为 `null`
* UI 层：

  * 标题、描述使用灰色 + 删除线
  * 在排序中排到未完成任务之后
  * 归档后可通过“显示归档”开关一起查看

### 3.3 任务排序逻辑

当前实现的排序策略：

1. 未完成任务排在已完成任务之前；
2. 在未完成任务中：

   * 有 `dueDate` 的排在前面；
   * 无 `dueDate` 的排在后面；
3. 有 `dueDate` 的任务按日期从早到晚；
4. 日期相同或任务都无日期时，按 `createdAt` 时间先后排序。

这样配置的原因：

* 符合常见使用习惯（先看还没完成且快到期的）。
* 避免拖拽排序与自动排序混在一起造成逻辑混乱。

### 3.4 简单提醒机制设计（过期高亮）

这是本项目对应“提醒/通知功能”的实现方式：

* 定义“需要提醒”的任务：

  * `!todo.completed && todo.dueDate && todo.dueDate < 今天`
* 在渲染时，对这样的任务 `<li>` 元素追加类名 `.todo-overdue`
* 在 CSS 中对 `.todo-overdue` 设计为明显但不刺眼的高亮

选择这种设计，而不是浏览器通知的原因：

* 不需要用户给予通知权限，不会被浏览器阻止。
* 实现简单，完全在前端渲染逻辑内部解决。
* 刷新页面后仍然有效（根据当前日期和任务日期动态判断）。

### 3.5 归档功能设计

1. 数据设计：

```js
archived: boolean,     // 是否归档
archivedAt: string|null // 归档时间（ISO）
```

2. 交互设计：

* 在每条任务右侧增加“归档 / 取消归档”按钮；
* 点击后：

  * 切换 `archived` 状态；
  * 设置或清空 `archivedAt`；
  * 重新渲染列表和统计图表。

3. 列表过滤：

* 页面有一个“显示归档”勾选框：

  * 默认未勾选：过滤掉 `archived === true` 的任务；
  * 勾选时：所有任务（含归档）都参与展示和筛选。

4. 设计取舍：

* 归档不是删除：

  * 保留历史数据，后续可以做更多统计或导出。
* 不做复杂分组/分页：

  * 符合“不要实现太多功能”的题目要求，只做简单可用的最小归档能力。

### 3.6 统计视图设计

* **今日完成任务分布（饼图）**

  * 使用 `completedAt === 今天` 的任务数据；
  * 按分类名称做聚合；
  * 如今日没有完成任务，隐藏饼图，展示一行“今日无完成任务”的提示。

* **近 7 天完成任务趋势（折线图）**

  * 从今天起往前 6 天，共 7 天；
  * 逐日统计 `completedAt === 当天` 的任务数量；
  * 用折线图展示趋势变化。

* **说明文案**

  * 顶部：“今日已完成 X 个任务”；
  * 折线图下：计算前七日平均完成数，与今日完成数对比，给出“增加 / 下降 / 持平”的文案。


## 4. AI 使用说明

### 4.1 使用的工具

* **ChatGPT**（GPT-5.1 Thinking）
* **trae**（GPT-5-medium）

### 4.2 使用 AI 的具体环节

1. 技术栈选择及框架设计
2. UI & 交互细节讨论
3. 代码草稿与重构建议
4. 文档表述建议


### 4.3 自己的修改与判断

* 所有与业务相关的关键逻辑（提醒规则、归档行为、排序策略、completedAt 写入策略等）均由我明确决定。
* 对 AI 提供的代码片段，基本过程是：
  * 先在脑子里过一遍逻辑是否符合当前数据结构与交互要求；
  * 贴到本地进行调试，观察边界情况（例如点击空白、Esc 按键、切换视图后数据是否同步）；
  * 不合适的地方再重写。


## 5. 运行与测试方式

### 5.1 本地运行方式

1. 克隆或下载项目代码。
2. 用浏览器直接打开 `index.html` 即可使用。

   * 无需构建、无需安装依赖（Chart.js 通过 CDN 引入）。

### 5.2 已测试环境

* 浏览器：

  * Chrome
  * Edge
* 系统：

  * macOS
  * Windows

（由于项目非常基础，现代主流浏览器理论上都可以正常运行。）

### 5.3 已知问题与不足

* 仅支持单设备 / 单浏览器的本地使用，不具备多设备同步能力。
* Chart.js 的样式配置比较基础，可以进一步美化。


## 6. 总结与反思

### 6.1 如果有更多时间会做什么

* 数据层面：

  * 增加“优先级”字段，在排序和统计中加入优先级维度。
  * 支持数据导出、导入，方便迁移备份。
* 交互层面：

  * 引入更细腻的交互反馈（过渡动画、空状态插画等）。
  * 对归档任务增加按月份/分类的归档视图，便于回顾历史。
* 架构层面：

  * 使用轻量框架（如 React + Vite）重构项目结构，增强可维护性。
  * 设计简单后端 API，尝试多设备同步和冲突解决策略。

### 6.2 个人认为的亮点

* 在满足题目基础要求的前提下，对**细节和体验**有一些额外打磨，复合提到的“简洁、易操作”的设计原则：

  * 日期编辑的“清除/自动保存/放弃修改”行为尽量贴近直觉。
  * 通过“过期高亮 + 归档开关”的方式，实现了一种简单但实用的提醒与历史管理逻辑。
  * 统计视图不仅展示图表，还通过“今日 vs 前七日平均”的说明文字帮助用户理解趋势。



