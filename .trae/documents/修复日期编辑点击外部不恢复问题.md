## 问题定位
- 现象：点击任务日期后不选择、不点“清除”，而是点击页面其它位置，编辑面板不会自动收起。
- 原因：日期编辑仅在`change`（选择后）与`Esc`时恢复；未实现“点击外部”或`blur`兜底。
- 受影响位置：
  - 单条任务日期编辑：`/Users/dl/Documents/todo-web/main.js:528–597`
  - 创建任务区域日期编辑：`/Users/dl/Documents/todo-web/main.js:741–804`

## 设计与实现
- 添加“点击外部关闭”监听：在打开编辑时，注册`document`级`mousedown`（捕获阶段）监听；若事件目标不在编辑容器`wrapper`内，则在未完成状态下执行恢复。
- 添加`blur`兜底：为日期`input`增加`blur`监听；当未选择（无`change`）直接失焦时恢复到原显示状态。
- 清理与幂等：在保存、清除或取消（`Esc`）时，移除文档级监听，防止泄漏与重复执行；用`finished`标志保证一次编辑只结束一次。
- 分场景恢复：
  - 单条任务编辑调用`renderTodos()`恢复（重渲染整项）
  - 创建区域编辑调用`finish()`恢复（替换回显示控件并更新文本）

## 变更点
- 文件`/Users/dl/Documents/todo-web/main.js`
  - `editTodoDueDate(...)`内新增：文档级`mousedown`外部点击监听与`input.blur`兜底；在`applyFromInput`、`handleClear`、`Esc`分支中统一清理监听。
  - `openCreateDueDateEditor()`内新增：同样的外部点击与`blur`兜底逻辑，并在`finish()`时清理。
- 不改动数据结构与存储逻辑；不影响现有`change`、`清除`、`Esc`行为。

## 验证用例
- 不选择日期→点击页面空白：编辑面板自动收起，显示原日期或“未选择任务日期”。
- 选择日期→离开输入：自动保存并恢复显示。
- 点击“清除”：设为未选择并恢复显示。
- 按`Esc`：放弃修改并恢复显示。
- 多次快速切换不同任务日期编辑：无残留全局监听、无重复触发。

## 风险与兼容
- 使用`mousedown`捕获阶段避免与按钮点击事件竞争；点击清除或选择日期时不会误触外部关闭。
- `input[type="date"]`在不同浏览器上的UI差异由浏览器处理；本方案仅依赖标准DOM事件，兼容性良好。

请确认后我将按上述方案修改`main.js`并完成验证。